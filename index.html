<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Alex's Cross-Border Currency Desk</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,600;9..144,700&family=Work+Sans:wght@400;500;600&display=swap" rel="stylesheet" />
  <style>
    :root {
      --ink: #1c1b22;
      --muted: #6a6777;
      --cream: #fff6ea;
      --peach: #ffd7c2;
      --mint: #c7f0e1;
      --rose: #f7c6d0;
      --sky: #cfe4ff;
      --accent: #ff7a72;
      --card: rgba(255, 255, 255, 0.85);
      --shadow: 0 18px 50px rgba(40, 20, 60, 0.12);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: "Work Sans", system-ui, -apple-system, sans-serif;
      color: var(--ink);
      background: radial-gradient(circle at top left, #ffe2cc 0, transparent 45%),
        radial-gradient(circle at 30% 20%, #d7f4ff 0, transparent 45%),
        radial-gradient(circle at 80% 10%, #fbd1e7 0, transparent 40%),
        linear-gradient(140deg, #fef7ef 0%, #f6f6ff 45%, #eff9f4 100%);
      min-height: 100vh;
    }

    .wrap {
      max-width: 1150px;
      margin: 0 auto;
      padding: 32px 20px 64px;
    }

    header {
      display: grid;
      gap: 12px;
      text-align: left;
      margin-bottom: 24px;
    }

    header h1 {
      font-family: "Fraunces", serif;
      font-size: clamp(2.2rem, 3vw, 3.1rem);
      margin: 0;
    }

    header p {
      margin: 0;
      color: var(--muted);
      font-size: 1rem;
    }

    .badge-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 4px;
    }

    .badge {
      padding: 6px 12px;
      border-radius: 999px;
      background: var(--card);
      box-shadow: 0 8px 20px rgba(30, 20, 60, 0.08);
      font-size: 0.85rem;
      color: var(--muted);
    }

    main {
      display: grid;
      gap: 24px;
    }

    .grid {
      display: grid;
      gap: 20px;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    }

    .card {
      background: var(--card);
      border-radius: 20px;
      padding: 20px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
    }

    .card h2 {
      font-family: "Fraunces", serif;
      font-size: 1.35rem;
      margin: 0 0 12px;
    }

    .field {
      display: grid;
      gap: 6px;
      margin-bottom: 12px;
    }

    .field label {
      font-size: 0.85rem;
      color: var(--muted);
    }

    input, select, button {
      font: inherit;
      font-size: 16px;
      padding: 12px 14px;
      min-height: 48px;
      border-radius: 12px;
      border: 1px solid rgba(0, 0, 0, 0.08);
      background: white;
    }

    button {
      cursor: pointer;
      background: linear-gradient(140deg, #ff9f8a, #ff6f99);
      color: #fff;
      border: none;
      font-weight: 600;
      min-height: 48px;
      transition: transform 0.15s ease, box-shadow 0.15s ease;
      box-shadow: 0 10px 20px rgba(255, 120, 130, 0.3);
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 26px rgba(255, 120, 130, 0.35);
    }

    .row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }

    .swap-row {
      align-items: flex-end;
    }

    .swap {
      background: #fff;
      color: var(--ink);
      border: 1px dashed rgba(0, 0, 0, 0.15);
      box-shadow: none;
      min-width: 52px;
      min-height: 48px;
      padding: 0;
      border-radius: 999px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 0.85rem;
      font-weight: 600;
      margin-bottom: 2px;
    }

    .result {
      font-size: 1.4rem;
      font-weight: 600;
      margin-top: 12px;
    }

    .muted {
      color: var(--muted);
    }

    .rates {
      display: grid;
      gap: 10px;
    }

    .rate-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 10px;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.7);
    }

    .card-art {
      width: 100%;
      height: 170px;
      object-fit: cover;
      margin-top: 14px;
      border-radius: 16px;
      opacity: 0.9;
      display: block;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      background: var(--cream);
      font-size: 0.85rem;
    }

    .footer-note {
      text-align: center;
      font-size: 0.85rem;
      color: var(--muted);
      margin-top: 24px;
    }

    .sparkle {
      display: inline-block;
      background: linear-gradient(120deg, #ffc3a0, #ffafbd, #b2fefa);
      -webkit-background-clip: text;
      color: transparent;
    }

    @media (max-width: 720px) {
      .wrap {
        padding: 20px 16px 48px;
      }

      .row {
        flex-direction: column;
        align-items: stretch;
      }

      .swap-row {
        flex-direction: row !important;
      }

      .swap {
        min-width: 48px;
        flex-shrink: 0;
      }

      button {
        width: 100%;
      }

      .grid {
        grid-template-columns: 1fr;
      }

      .card {
        padding: 18px;
      }

      header h1 {
        font-size: 2rem;
      }
    }

    /* Prevent iOS Safari zoom on input focus */
    @supports (-webkit-touch-callout: none) {
      input, select {
        font-size: 16px !important;
      }
    }

    /* Password protection overlay */
    .password-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(140deg, #fef7ef 0%, #f6f6ff 45%, #eff9f4 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }

    .password-overlay.hidden {
      display: none;
    }

    .password-box {
      background: var(--card);
      border-radius: 20px;
      padding: 40px;
      box-shadow: var(--shadow);
      max-width: 400px;
      width: 90%;
      text-align: center;
    }

    .password-box h2 {
      font-family: "Fraunces", serif;
      font-size: 1.8rem;
      margin: 0 0 12px;
    }

    .password-box p {
      color: var(--muted);
      margin: 0 0 24px;
    }

    .password-box input {
      width: 100%;
      margin-bottom: 16px;
      text-align: center;
      letter-spacing: 2px;
    }

    .password-box input::placeholder {
      opacity: 0.5;
    }

    .password-box input:focus::placeholder {
      opacity: 0;
    }

    .password-box button {
      width: 100%;
    }

    .password-error {
      color: var(--accent);
      font-size: 0.9rem;
      margin-top: 12px;
      min-height: 20px;
    }

    .content-wrapper {
      display: none;
    }

    .content-wrapper.unlocked {
      display: block;
    }
  </style>
</head>
<body>
  <div id="password-overlay" class="password-overlay">
    <div class="password-box">
      <h2>üîê Protected Access</h2>
      <p>Enter the passcode to access Alex's Currency Desk</p>
      <input id="password-input" type="password" placeholder="Enter passcode" autocomplete="off" />
      <button id="password-submit">Unlock</button>
      <div id="password-error" class="password-error"></div>
    </div>
  </div>

  <div id="content-wrapper" class="content-wrapper">
  <div class="wrap">
    <header>
      <h1>Alex's <span class="sparkle">Cross-Border</span> Currency Desk</h1>
      <p>Elegant, cute, and made for a Shenzhen seller running stores across Vietnam, Thailand, and Malaysia.</p>
      <div class="badge-row">
        <span class="badge" id="status-badge">Fetching live rates...</span>
        <span class="badge">Shopee + TikTok shop ready</span>
        <span class="badge">Open this file to use anywhere</span>
      </div>
    </header>

    <main>
      <section class="grid">
        <div class="card">
          <h2>Quick Convert</h2>
          <div class="field">
            <label for="amount">Amount</label>
            <input id="amount" type="number" step="0.01" value="100" />
          </div>
          <div class="row swap-row">
            <div class="field" style="flex: 1; min-width: 140px;">
              <label for="from">From</label>
              <select id="from"></select>
            </div>
            <button class="swap" id="swap" type="button" aria-label="Swap currencies">Swap</button>
            <div class="field" style="flex: 1; min-width: 140px;">
              <label for="to">To</label>
              <select id="to"></select>
            </div>
          </div>
          <div class="row" style="margin-top: 8px;">
            <button id="convert" type="button">Convert</button>
            <span class="pill" id="rate-line">Rate: --</span>
          </div>
          <div class="result" id="result">--</div>
          <img class="card-art" src="https://images.pexels.com/photos/5942707/pexels-photo-5942707.jpeg?cs=srgb&dl=pexels-karola-g-5942707.jpg&fm=jpg" alt="Desk with currency notes and calculator" loading="lazy" />
        </div>

        <div class="card">
          <h2>Live Rate Glance</h2>
          <div class="rates" id="rates"></div>
          <img class="card-art" src="https://images.pexels.com/photos/8441819/pexels-photo-8441819.jpeg?cs=srgb&dl=pexels-kampus-8441819.jpg&fm=jpg" alt="Laptop with analytics dashboard" loading="lazy" />
        </div>

        <div class="card">
          <h2>Platform Margin Check</h2>
          <div class="field">
            <label for="cost">Cost (RMB)</label>
            <input id="cost" type="number" step="0.01" value="55" />
          </div>
          <div class="field">
            <label for="sell">Selling price (local currency)</label>
            <input id="sell" type="number" step="0.01" value="180" />
          </div>
          <div class="field">
            <label for="sell-currency">Selling currency</label>
            <select id="sell-currency"></select>
          </div>
          <div class="row">
            <div class="field" style="flex: 1;">
              <label for="fee">Platform fee %</label>
              <input id="fee" type="number" step="0.1" value="6" />
            </div>
            <div class="field" style="flex: 1;">
              <label for="ads">Ads %</label>
              <input id="ads" type="number" step="0.1" value="4" />
            </div>
          </div>
          <div class="field">
            <label for="shipping">Shipping + fulfillment (RMB)</label>
            <input id="shipping" type="number" step="0.01" value="12" />
          </div>
          <div class="result" id="margin-result">--</div>
          <p class="muted">Adjust fee/ads based on Shopee or TikTok promos.</p>
        </div>
      </section>

      <section class="grid">
        <div class="card">
          <h2>Payout Planner</h2>
          <div class="field">
            <label for="daily">Daily revenue (local currency)</label>
            <input id="daily" type="number" step="0.01" value="850" />
          </div>
          <div class="field">
            <label for="daily-currency">Revenue currency</label>
            <select id="daily-currency"></select>
          </div>
          <div class="field">
            <label for="days">Days to project</label>
            <input id="days" type="number" step="1" value="14" />
          </div>
          <div class="result" id="payout-result">--</div>
        </div>

        <div class="card">
          <h2>Charm Pricing Helper</h2>
          <div class="field">
            <label for="base-rmb">Base price (RMB)</label>
            <input id="base-rmb" type="number" step="0.01" value="68" />
          </div>
          <div class="field">
            <label for="charm-currency">Target currency</label>
            <select id="charm-currency"></select>
          </div>
          <div class="field">
            <label for="charm-style">Charm style</label>
            <select id="charm-style">
              <option value="none">No charm</option>
              <option value=".90">.90</option>
              <option value=".95">.95</option>
              <option value=".99">.99</option>
            </select>
          </div>
          <div class="result" id="charm-result">--</div>
          <p class="muted">Great for Shopee listings and TikTok live bundles.</p>
        </div>

        <div class="card">
          <h2>Notes for Alex</h2>
          <p class="muted">- Keep promo fees + ads updated for each campaign.</p>
          <p class="muted">- Use VND, THB, MYR quick rates before repricing SKUs.</p>
          <p class="muted">- Share this file directly; it runs offline after the first rate load.</p>
        </div>
      </section>
    </main>

    <div class="footer-note">Rates powered by a daily open currency feed. Last updated: <span id="updated">--</span>.</div>
  </div>
  </div>

  <script>
    // Password protection
    (function() {
      const CORRECT_PASSWORD = "sfls";
      const overlay = document.getElementById("password-overlay");
      const contentWrapper = document.getElementById("content-wrapper");
      const passwordInput = document.getElementById("password-input");
      const passwordSubmit = document.getElementById("password-submit");
      const passwordError = document.getElementById("password-error");

      // Check if already authenticated in this session
      if (sessionStorage.getItem("alex-desk-auth") === "true") {
        overlay.classList.add("hidden");
        contentWrapper.classList.add("unlocked");
        initApp();
        return;
      }

      function checkPassword() {
        const input = passwordInput.value.toLowerCase().trim();
        if (input === CORRECT_PASSWORD) {
          sessionStorage.setItem("alex-desk-auth", "true");
          overlay.classList.add("hidden");
          contentWrapper.classList.add("unlocked");
          passwordError.textContent = "";
          initApp();
        } else {
          passwordError.textContent = "‚ùå Incorrect passcode. Try again.";
          passwordInput.value = "";
          passwordInput.focus();
        }
      }

      passwordSubmit.addEventListener("click", checkPassword);
      passwordInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") checkPassword();
      });

      // Focus password input on load
      setTimeout(() => passwordInput.focus(), 100);
    })();

    function initApp() {
    const CURRENCIES = {
      USD: "US Dollar",
      CNY: "Chinese Yuan (RMB)",
      VND: "Vietnamese Dong",
      THB: "Thai Baht",
      MYR: "Malaysian Ringgit"
    };

    const cache = {};
    const primaryBase = "https://cdn.jsdelivr.net/npm/@fawazahmed0/currency-api@latest/v1/currencies";
    const fallbackBase = "https://latest.currency-api.pages.dev/v1/currencies";

    const elements = {
      amount: document.getElementById("amount"),
      from: document.getElementById("from"),
      to: document.getElementById("to"),
      swap: document.getElementById("swap"),
      convert: document.getElementById("convert"),
      result: document.getElementById("result"),
      rateLine: document.getElementById("rate-line"),
      rates: document.getElementById("rates"),
      status: document.getElementById("status-badge"),
      updated: document.getElementById("updated"),
      cost: document.getElementById("cost"),
      sell: document.getElementById("sell"),
      sellCurrency: document.getElementById("sell-currency"),
      fee: document.getElementById("fee"),
      ads: document.getElementById("ads"),
      shipping: document.getElementById("shipping"),
      marginResult: document.getElementById("margin-result"),
      daily: document.getElementById("daily"),
      dailyCurrency: document.getElementById("daily-currency"),
      days: document.getElementById("days"),
      payoutResult: document.getElementById("payout-result"),
      baseRmb: document.getElementById("base-rmb"),
      charmCurrency: document.getElementById("charm-currency"),
      charmStyle: document.getElementById("charm-style"),
      charmResult: document.getElementById("charm-result")
    };

    function populateSelect(select, defaultValue) {
      select.innerHTML = Object.entries(CURRENCIES)
        .map(([code, name]) => `<option value="${code}">${code} - ${name}</option>`)
        .join("");
      select.value = defaultValue;
    }

    function formatCurrency(value, code) {
      try {
        return new Intl.NumberFormat("en-US", {
          style: "currency",
          currency: code,
          maximumFractionDigits: 2
        }).format(value);
      } catch {
        return `${value.toFixed(2)} ${code}`;
      }
    }

    function formatNumber(value) {
      return new Intl.NumberFormat("en-US", {
        maximumFractionDigits: 4
      }).format(value);
    }

    async function fetchRates(base) {
      const key = base.toLowerCase();
      if (cache[key]) return cache[key];

      const urls = [
        `${primaryBase}/${key}.min.json`,
        `${fallbackBase}/${key}.min.json`
      ];

      for (const url of urls) {
        try {
          const response = await fetch(url);
          if (!response.ok) continue;
          const data = await response.json();
          cache[key] = data;
          return data;
        } catch {
          // Try the next source
        }
      }
      throw new Error("Unable to load rates");
    }

    async function getRate(from, to) {
      if (from === to) return 1;
      const data = await fetchRates(from);
      const key = to.toLowerCase();
      return data[from.toLowerCase()][key];
    }

    async function updateConverter() {
      const amount = parseFloat(elements.amount.value) || 0;
      const from = elements.from.value;
      const to = elements.to.value;
      try {
        const rate = await getRate(from, to);
        const converted = amount * rate;
        elements.result.textContent = formatCurrency(converted, to);
        elements.rateLine.textContent = `Rate: 1 ${from} = ${formatNumber(rate)} ${to}`;
        elements.status.textContent = "Live rates ready";
      } catch {
        elements.status.textContent = "Unable to fetch rates";
      }
    }

    async function updateRatesPanel() {
      try {
        const data = await fetchRates("USD");
        const rates = data.usd;
        const targets = ["CNY", "VND", "THB", "MYR"];
        elements.rates.innerHTML = targets
          .map((code) => {
            const value = rates[code.toLowerCase()];
            return `<div class="rate-item"><span>1 USD ‚Üí ${code}</span><strong>${formatNumber(value)}</strong></div>`;
          })
          .join("");
        elements.updated.textContent = data.date;
        elements.status.textContent = `Live rates updated ${data.date}`;
      } catch {
        elements.rates.innerHTML = `<div class="rate-item">Rates unavailable. Try refreshing.</div>`;
      }
    }

    async function updateMargin() {
      const cost = parseFloat(elements.cost.value) || 0;
      const sell = parseFloat(elements.sell.value) || 0;
      const sellCurrency = elements.sellCurrency.value;
      const fee = (parseFloat(elements.fee.value) || 0) / 100;
      const ads = (parseFloat(elements.ads.value) || 0) / 100;
      const shipping = parseFloat(elements.shipping.value) || 0;

      try {
        const rate = await getRate(sellCurrency, "CNY");
        const revenueRmb = sell * rate;
        const netRmb = revenueRmb * (1 - fee - ads) - shipping - cost;
        const margin = revenueRmb ? (netRmb / revenueRmb) * 100 : 0;
        elements.marginResult.textContent = `${formatCurrency(netRmb, "CNY")} profit ‚Ä¢ ${margin.toFixed(1)}% margin`;
      } catch {
        elements.marginResult.textContent = "--";
      }
    }

    async function updatePayout() {
      const daily = parseFloat(elements.daily.value) || 0;
      const days = parseFloat(elements.days.value) || 0;
      const currency = elements.dailyCurrency.value;
      try {
        const total = daily * days;
        const toRmb = await getRate(currency, "CNY");
        const toUsd = await getRate(currency, "USD");
        const rmbTotal = total * toRmb;
        const usdTotal = total * toUsd;
        elements.payoutResult.textContent = `${formatCurrency(total, currency)} ‚Üí ${formatCurrency(rmbTotal, "CNY")} / ${formatCurrency(usdTotal, "USD")}`;
      } catch {
        elements.payoutResult.textContent = "--";
      }
    }

    function applyCharm(value, style) {
      if (style === "none") return value;
      const charm = parseFloat(style);
      let base = Math.floor(value);
      let candidate = base + charm;
      if (candidate < value) {
        candidate = base + 1 + charm;
      }
      return candidate;
    }

    async function updateCharm() {
      const baseRmb = parseFloat(elements.baseRmb.value) || 0;
      const currency = elements.charmCurrency.value;
      const style = elements.charmStyle.value;
      try {
        const rate = await getRate("CNY", currency);
        const raw = baseRmb * rate;
        const priced = applyCharm(raw, style);
        elements.charmResult.textContent = `${formatCurrency(priced, currency)} (raw ${formatCurrency(raw, currency)})`;
      } catch {
        elements.charmResult.textContent = "--";
      }
    }

    function bindUpdates() {
      [
        elements.amount,
        elements.from,
        elements.to
      ].forEach((el) => el.addEventListener("input", updateConverter));

      elements.swap.addEventListener("click", () => {
        const temp = elements.from.value;
        elements.from.value = elements.to.value;
        elements.to.value = temp;
        updateConverter();
      });

      elements.convert.addEventListener("click", updateConverter);

      [
        elements.cost,
        elements.sell,
        elements.sellCurrency,
        elements.fee,
        elements.ads,
        elements.shipping
      ].forEach((el) => el.addEventListener("input", updateMargin));

      [
        elements.daily,
        elements.dailyCurrency,
        elements.days
      ].forEach((el) => el.addEventListener("input", updatePayout));

      [
        elements.baseRmb,
        elements.charmCurrency,
        elements.charmStyle
      ].forEach((el) => el.addEventListener("input", updateCharm));
    }

    populateSelect(elements.from, "CNY");
    populateSelect(elements.to, "VND");
    populateSelect(elements.sellCurrency, "VND");
    populateSelect(elements.dailyCurrency, "THB");
    populateSelect(elements.charmCurrency, "MYR");
    bindUpdates();
    updateRatesPanel();
    updateConverter();
    updateMargin();
    updatePayout();
    updateCharm();
    }
  </script>
</body>
</html>
